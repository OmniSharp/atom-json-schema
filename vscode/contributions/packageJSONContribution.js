'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.PackageJSONContribution = undefined;

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _strings = require('../common/strings');

var _strings2 = _interopRequireDefault(_strings);

var _requestLight = require('request-light');

var _requestLight2 = _interopRequireDefault(_requestLight);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var LIMIT = 40;

var PackageJSONContribution = exports.PackageJSONContribution = function () {
    function PackageJSONContribution() {
        _classCallCheck(this, PackageJSONContribution);

        this.mostDependedOn = ['lodash', 'async', 'underscore', 'request', 'commander', 'express', 'debug', 'chalk', 'colors', 'q', 'coffee-script', 'mkdirp', 'optimist', 'through2', 'yeoman-generator', 'moment', 'bluebird', 'glob', 'gulp-util', 'minimist', 'cheerio', 'jade', 'redis', 'node-uuid', 'socket', 'io', 'uglify-js', 'winston', 'through', 'fs-extra', 'handlebars', 'body-parser', 'rimraf', 'mime', 'semver', 'mongodb', 'jquery', 'grunt', 'connect', 'yosay', 'underscore', 'string', 'xml2js', 'ejs', 'mongoose', 'marked', 'extend', 'mocha', 'superagent', 'js-yaml', 'xtend', 'shelljs', 'gulp', 'yargs', 'browserify', 'minimatch', 'react', 'less', 'prompt', 'inquirer', 'ws', 'event-stream', 'inherits', 'mysql', 'esprima', 'jsdom', 'stylus', 'when', 'readable-stream', 'aws-sdk', 'concat-stream', 'chai', 'promise', 'wrench'];
    }

    _createClass(PackageJSONContribution, [{
        key: 'isPackageJSONFile',
        value: function isPackageJSONFile(resource) {
            var path = resource.path;
            return _strings2.default.endsWith(path, '/package.json');
        }
    }, {
        key: 'collectDefaultSuggestions',
        value: function collectDefaultSuggestions(resource, result) {
            if (this.isPackageJSONFile(resource)) {
                var defaultValue = {
                    'name': '{{name}}',
                    'description': '{{description}}',
                    'author': '{{author}}',
                    'version': '{{1.0.0}}',
                    'main': '{{pathToMain}}',
                    'dependencies': {}
                };
                result.add({ type: 'module', displayText: 'Default package.json', snippet: JSON.stringify(defaultValue, null, '\t'), description: '' });
            }
            return null;
        }
    }, {
        key: 'collectPropertySuggestions',
        value: function collectPropertySuggestions(resource, location, currentWord, addValue, isLast, result) {
            if (this.isPackageJSONFile(resource) && (location.matches(['dependencies']) || location.matches(['devDependencies']) || location.matches(['optionalDependencies']) || location.matches(['peerDependencies']))) {
                var queryUrl;
                if (currentWord.length > 0) {
                    queryUrl = 'https://skimdb.npmjs.com/registry/_design/app/_view/browseAll?group_level=1&limit=' + LIMIT + '&start_key=%5B%22' + encodeURIComponent(currentWord) + '%22%5D&end_key=%5B%22' + encodeURIComponent(currentWord + 'z') + '%22,%7B%7D%5D';
                    return _requestLight2.default.xhr({
                        url: queryUrl
                    }).then(function (success) {
                        if (success.status === 200) {
                            try {
                                var obj = JSON.parse(success.responseText);
                                if (obj && Array.isArray(obj.rows)) {
                                    var results = obj.rows;
                                    for (var i = 0; i < results.length; i++) {
                                        var keys = results[i].key;
                                        if (Array.isArray(keys) && keys.length > 0) {
                                            var name = keys[0];
                                            var codeSnippet = JSON.stringify(name);
                                            if (addValue) {
                                                codeSnippet += ': "{{*}}"';
                                                if (!isLast) {
                                                    codeSnippet += ',';
                                                }
                                            }
                                            result.add({ type: 'property', displayText: name, snippet: codeSnippet, description: '' });
                                        }
                                    }
                                    if (results.length === LIMIT) {
                                        result.setAsIncomplete();
                                    }
                                }
                            } catch (e) {}
                        } else {
                            result.error('Request to the NPM repository failed: ' + success.responseText);
                            return 0;
                        }
                    }, function (error) {
                        result.error('Request to the NPM repository failed: ' + error.responseText);
                        return 0;
                    });
                } else {
                    this.mostDependedOn.forEach(function (name) {
                        var codeSnippet = JSON.stringify(name);
                        if (addValue) {
                            codeSnippet += ': "{{*}}"';
                            if (!isLast) {
                                codeSnippet += ',';
                            }
                        }
                        result.add({ type: 'property', displayText: name, snippet: codeSnippet, description: '' });
                    });
                    result.setAsIncomplete();
                }
            }
            return null;
        }
    }, {
        key: 'collectValueSuggestions',
        value: function collectValueSuggestions(resource, location, currentKey, result) {
            if (this.isPackageJSONFile(resource) && (location.matches(['dependencies']) || location.matches(['devDependencies']) || location.matches(['optionalDependencies']) || location.matches(['peerDependencies']))) {
                var queryUrl = 'http://registry.npmjs.org/' + encodeURIComponent(currentKey) + '/latest';
                return _requestLight2.default.xhr({
                    url: queryUrl
                }).then(function (success) {
                    try {
                        var obj = JSON.parse(success.responseText);
                        if (obj && obj.version) {
                            var version = obj.version;
                            var name = JSON.stringify(version);
                            result.add({ type: 'class', displayText: name, snippet: name, description: 'The currently latest version of the package' });
                            name = JSON.stringify('^' + version);
                            result.add({ type: 'class', displayText: name, snippet: name, description: 'Matches the most recent major version (1.x.x)' });
                            name = JSON.stringify('~' + version);
                            result.add({ type: 'class', displayText: name, snippet: name, description: 'Matches the most recent minor version (1.2.x)' });
                        }
                    } catch (e) {}
                    return 0;
                }, function (error) {
                    return 0;
                });
            }
            return null;
        }
    }, {
        key: 'getInfoContribution',
        value: function getInfoContribution(resource, location) {
            if (this.isPackageJSONFile(resource) && (location.matches(['dependencies', '*']) || location.matches(['devDependencies', '*']) || location.matches(['optionalDependencies', '*']) || location.matches(['peerDependencies', '*']))) {
                var pack = location.getSegments()[location.getSegments().length - 1];
                var htmlContent = [];
                htmlContent.push({ className: 'type', text: pack });
                var queryUrl = 'http://registry.npmjs.org/' + encodeURIComponent(pack) + '/latest';
                return _requestLight2.default.xhr({
                    url: queryUrl
                }).then(function (success) {
                    try {
                        var obj = JSON.parse(success.responseText);
                        if (obj) {
                            if (obj.description) {
                                htmlContent.push({ className: 'documentation', text: obj.description });
                            }
                            if (obj.version) {
                                htmlContent.push({ className: 'documentation', text: 'Latest version: ' + obj.version });
                            }
                        }
                    } catch (e) {}
                    return htmlContent;
                }, function (error) {
                    return htmlContent;
                });
            }
            return null;
        }
    }]);

    return PackageJSONContribution;
}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInZzY29kZS9jb250cmlidXRpb25zL3BhY2thZ2VKU09OQ29udHJpYnV0aW9uLnRzIiwidnNjb2RlL2NvbnRyaWJ1dGlvbnMvcGFja2FnZUpTT05Db250cmlidXRpb24uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBSUE7Ozs7Ozs7OztBQ0hBOzs7O0FBQ0E7Ozs7Ozs7O0FEV0EsSUFBSSxRQUFRLEVBQVo7O0lBRUEsdUIsV0FBQSx1QjtBQWNJLHVDQUFBO0FBQUE7O0FBWlEsYUFBQSxjQUFBLEdBQWlCLENBQUUsUUFBRixFQUFZLE9BQVosRUFBcUIsWUFBckIsRUFBbUMsU0FBbkMsRUFBOEMsV0FBOUMsRUFBMkQsU0FBM0QsRUFBc0UsT0FBdEUsRUFBK0UsT0FBL0UsRUFBd0YsUUFBeEYsRUFBa0csR0FBbEcsRUFBdUcsZUFBdkcsRUFDckIsUUFEcUIsRUFDWCxVQURXLEVBQ0MsVUFERCxFQUNhLGtCQURiLEVBQ2lDLFFBRGpDLEVBQzJDLFVBRDNDLEVBQ3VELE1BRHZELEVBQytELFdBRC9ELEVBQzRFLFVBRDVFLEVBQ3dGLFNBRHhGLEVBQ21HLE1BRG5HLEVBQzJHLE9BRDNHLEVBQ29ILFdBRHBILEVBRXJCLFFBRnFCLEVBRVgsSUFGVyxFQUVMLFdBRkssRUFFUSxTQUZSLEVBRW1CLFNBRm5CLEVBRThCLFVBRjlCLEVBRTBDLFlBRjFDLEVBRXdELGFBRnhELEVBRXVFLFFBRnZFLEVBRWlGLE1BRmpGLEVBRXlGLFFBRnpGLEVBRW1HLFNBRm5HLEVBRThHLFFBRjlHLEVBR3JCLE9BSHFCLEVBR1osU0FIWSxFQUdELE9BSEMsRUFHUSxZQUhSLEVBR3NCLFFBSHRCLEVBR2dDLFFBSGhDLEVBRzBDLEtBSDFDLEVBR2lELFVBSGpELEVBRzZELFFBSDdELEVBR3VFLFFBSHZFLEVBR2lGLE9BSGpGLEVBRzBGLFlBSDFGLEVBR3dHLFNBSHhHLEVBR21ILE9BSG5ILEVBSXJCLFNBSnFCLEVBSVYsTUFKVSxFQUlGLE9BSkUsRUFJTyxZQUpQLEVBSXFCLFdBSnJC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ZmlsZSI6InZzY29kZS9jb250cmlidXRpb25zL3BhY2thZ2VKU09OQ29udHJpYnV0aW9uLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cclxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbid1c2Ugc3RyaWN0JztcclxuXHJcbmltcG9ydCBIdG1sQ29udGVudCBmcm9tICcuLi9jb21tb24vaHRtbENvbnRlbnQnO1xyXG5pbXBvcnQgU3RyaW5ncyBmcm9tICcuLi9jb21tb24vc3RyaW5ncyc7XHJcbmltcG9ydCBKU09OV29ya2VyIGZyb20gJy4uL2pzb25Xb3JrZXInO1xyXG5pbXBvcnQgVVJJIGZyb20gJy4uL2NvbW1vbi91cmknO1xyXG5pbXBvcnQge0pTT05Mb2NhdGlvbn0gZnJvbSAnLi4vcGFyc2VyL2pzb25Mb2NhdGlvbic7XHJcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3JlcXVlc3QtbGlnaHQnO1xyXG5cclxudmFyIExJTUlUID0gNDA7XHJcblxyXG5leHBvcnQgY2xhc3MgUGFja2FnZUpTT05Db250cmlidXRpb24gaW1wbGVtZW50cyBKU09OV29ya2VyLklKU09OV29ya2VyQ29udHJpYnV0aW9uIHtcclxuXHJcbiAgICBwcml2YXRlIG1vc3REZXBlbmRlZE9uID0gWyAnbG9kYXNoJywgJ2FzeW5jJywgJ3VuZGVyc2NvcmUnLCAncmVxdWVzdCcsICdjb21tYW5kZXInLCAnZXhwcmVzcycsICdkZWJ1ZycsICdjaGFsaycsICdjb2xvcnMnLCAncScsICdjb2ZmZWUtc2NyaXB0JyxcclxuICAgICAgICAnbWtkaXJwJywgJ29wdGltaXN0JywgJ3Rocm91Z2gyJywgJ3llb21hbi1nZW5lcmF0b3InLCAnbW9tZW50JywgJ2JsdWViaXJkJywgJ2dsb2InLCAnZ3VscC11dGlsJywgJ21pbmltaXN0JywgJ2NoZWVyaW8nLCAnamFkZScsICdyZWRpcycsICdub2RlLXV1aWQnLFxyXG4gICAgICAgICdzb2NrZXQnLCAnaW8nLCAndWdsaWZ5LWpzJywgJ3dpbnN0b24nLCAndGhyb3VnaCcsICdmcy1leHRyYScsICdoYW5kbGViYXJzJywgJ2JvZHktcGFyc2VyJywgJ3JpbXJhZicsICdtaW1lJywgJ3NlbXZlcicsICdtb25nb2RiJywgJ2pxdWVyeScsXHJcbiAgICAgICAgJ2dydW50JywgJ2Nvbm5lY3QnLCAneW9zYXknLCAndW5kZXJzY29yZScsICdzdHJpbmcnLCAneG1sMmpzJywgJ2VqcycsICdtb25nb29zZScsICdtYXJrZWQnLCAnZXh0ZW5kJywgJ21vY2hhJywgJ3N1cGVyYWdlbnQnLCAnanMteWFtbCcsICd4dGVuZCcsXHJcbiAgICAgICAgJ3NoZWxsanMnLCAnZ3VscCcsICd5YXJncycsICdicm93c2VyaWZ5JywgJ21pbmltYXRjaCcsICdyZWFjdCcsICdsZXNzJywgJ3Byb21wdCcsICdpbnF1aXJlcicsICd3cycsICdldmVudC1zdHJlYW0nLCAnaW5oZXJpdHMnLCAnbXlzcWwnLCAnZXNwcmltYScsXHJcbiAgICAgICAgJ2pzZG9tJywgJ3N0eWx1cycsICd3aGVuJywgJ3JlYWRhYmxlLXN0cmVhbScsICdhd3Mtc2RrJywgJ2NvbmNhdC1zdHJlYW0nLCAnY2hhaScsICdwcm9taXNlJywgJ3dyZW5jaCddO1xyXG5cclxuICAgIHByaXZhdGUgaXNQYWNrYWdlSlNPTkZpbGUocmVzb3VyY2U6IFVSSSk6IGJvb2xlYW4ge1xyXG4gICAgICAgIHZhciBwYXRoID0gcmVzb3VyY2UucGF0aDtcclxuICAgICAgICByZXR1cm4gU3RyaW5ncy5lbmRzV2l0aChwYXRoLCAnL3BhY2thZ2UuanNvbicpO1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3RvcigpIHtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY29sbGVjdERlZmF1bHRTdWdnZXN0aW9ucyhyZXNvdXJjZTogVVJJLCByZXN1bHQ6IEpTT05Xb3JrZXIuSVN1Z2dlc3Rpb25zQ29sbGVjdG9yKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBpZiAodGhpcy5pc1BhY2thZ2VKU09ORmlsZShyZXNvdXJjZSkpIHtcclxuICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IHtcclxuICAgICAgICAgICAgICAgICduYW1lJzogJ3t7bmFtZX19JyxcclxuICAgICAgICAgICAgICAgICdkZXNjcmlwdGlvbic6ICd7e2Rlc2NyaXB0aW9ufX0nLFxyXG4gICAgICAgICAgICAgICAgJ2F1dGhvcic6ICd7e2F1dGhvcn19JyxcclxuICAgICAgICAgICAgICAgICd2ZXJzaW9uJzogJ3t7MS4wLjB9fScsXHJcbiAgICAgICAgICAgICAgICAnbWFpbic6ICd7e3BhdGhUb01haW59fScsXHJcbiAgICAgICAgICAgICAgICAnZGVwZW5kZW5jaWVzJzoge31cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmVzdWx0LmFkZCh7IHR5cGU6ICdtb2R1bGUnLCBkaXNwbGF5VGV4dDogYERlZmF1bHQgcGFja2FnZS5qc29uYCwgc25pcHBldDogSlNPTi5zdHJpbmdpZnkoZGVmYXVsdFZhbHVlLCBudWxsLCAnXFx0JyksIGRlc2NyaXB0aW9uOiAnJyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIGNvbGxlY3RQcm9wZXJ0eVN1Z2dlc3Rpb25zKHJlc291cmNlOiBVUkksIGxvY2F0aW9uOiBKU09OTG9jYXRpb24sIGN1cnJlbnRXb3JkOiBzdHJpbmcsIGFkZFZhbHVlOiBib29sZWFuLCBpc0xhc3Q6Ym9vbGVhbiwgcmVzdWx0OiBKU09OV29ya2VyLklTdWdnZXN0aW9uc0NvbGxlY3RvcikgOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIGlmICh0aGlzLmlzUGFja2FnZUpTT05GaWxlKHJlc291cmNlKSAmJiAobG9jYXRpb24ubWF0Y2hlcyhbJ2RlcGVuZGVuY2llcyddKSB8fCBsb2NhdGlvbi5tYXRjaGVzKFsnZGV2RGVwZW5kZW5jaWVzJ10pIHx8IGxvY2F0aW9uLm1hdGNoZXMoWydvcHRpb25hbERlcGVuZGVuY2llcyddKSB8fCBsb2NhdGlvbi5tYXRjaGVzKFsncGVlckRlcGVuZGVuY2llcyddKSkpIHtcclxuICAgICAgICAgICAgdmFyIHF1ZXJ5VXJsIDogc3RyaW5nO1xyXG4gICAgICAgICAgICBpZiAoY3VycmVudFdvcmQubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgcXVlcnlVcmwgPSAnaHR0cHM6Ly9za2ltZGIubnBtanMuY29tL3JlZ2lzdHJ5L19kZXNpZ24vYXBwL192aWV3L2Jyb3dzZUFsbD9ncm91cF9sZXZlbD0xJmxpbWl0PScgKyBMSU1JVCArICcmc3RhcnRfa2V5PSU1QiUyMicgKyBlbmNvZGVVUklDb21wb25lbnQoY3VycmVudFdvcmQpICsgJyUyMiU1RCZlbmRfa2V5PSU1QiUyMicrIGVuY29kZVVSSUNvbXBvbmVudChjdXJyZW50V29yZCArICd6JykgKyAnJTIyLCU3QiU3RCU1RCc7XHJcblxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QueGhyKHtcclxuICAgICAgICAgICAgICAgICAgICB1cmwgOiBxdWVyeVVybFxyXG4gICAgICAgICAgICAgICAgfSkudGhlbigoc3VjY2VzcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChzdWNjZXNzLnN0YXR1cyA9PT0gMjAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShzdWNjZXNzLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqICYmIEFycmF5LmlzQXJyYXkob2JqLnJvd3MpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSA8eyBrZXk6IHN0cmluZ1tdOyB9W10+IG9iai5yb3dzO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0cy5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5cyA9IHJlc3VsdHNbaV0ua2V5O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShrZXlzKSAmJiBrZXlzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0ga2V5c1swXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlU25pcHBldCA9IEpTT04uc3RyaW5naWZ5KG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZFZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZVNuaXBwZXQgKz0gJzogXCJ7eyp9fVwiJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTGFzdCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlU25pcHBldCArPSAnLCc7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZCh7IHR5cGU6ICdwcm9wZXJ0eScsIGRpc3BsYXlUZXh0OiBuYW1lLCBzbmlwcGV0OiBjb2RlU25pcHBldCwgZGVzY3JpcHRpb246ICcnIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gTElNSVQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNldEFzSW5jb21wbGV0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuZXJyb3IoYFJlcXVlc3QgdG8gdGhlIE5QTSByZXBvc2l0b3J5IGZhaWxlZDogJHtzdWNjZXNzLnJlc3BvbnNlVGV4dH1gKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgKGVycm9yKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmVycm9yKGBSZXF1ZXN0IHRvIHRoZSBOUE0gcmVwb3NpdG9yeSBmYWlsZWQ6ICR7ZXJyb3IucmVzcG9uc2VUZXh0fWApO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLm1vc3REZXBlbmRlZE9uLmZvckVhY2goKG5hbWUpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY29kZVNuaXBwZXQgPSBKU09OLnN0cmluZ2lmeShuYW1lKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoYWRkVmFsdWUpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29kZVNuaXBwZXQgKz0gJzogXCJ7eyp9fVwiJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFpc0xhc3QpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVTbmlwcGV0ICs9ICcsJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkKHsgdHlwZTogJ3Byb3BlcnR5JywgZGlzcGxheVRleHQ6IG5hbWUsIHNuaXBwZXQ6IGNvZGVTbmlwcGV0LCBkZXNjcmlwdGlvbjogJycgfSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5zZXRBc0luY29tcGxldGUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgY29sbGVjdFZhbHVlU3VnZ2VzdGlvbnMocmVzb3VyY2U6IFVSSSwgbG9jYXRpb246IEpTT05Mb2NhdGlvbiwgY3VycmVudEtleTogc3RyaW5nLCByZXN1bHQ6IEpTT05Xb3JrZXIuSVN1Z2dlc3Rpb25zQ29sbGVjdG9yKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBpZiAodGhpcy5pc1BhY2thZ2VKU09ORmlsZShyZXNvdXJjZSkgJiYgKGxvY2F0aW9uLm1hdGNoZXMoWydkZXBlbmRlbmNpZXMnXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ2RldkRlcGVuZGVuY2llcyddKSB8fCBsb2NhdGlvbi5tYXRjaGVzKFsnb3B0aW9uYWxEZXBlbmRlbmNpZXMnXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ3BlZXJEZXBlbmRlbmNpZXMnXSkpKSB7XHJcbiAgICAgICAgICAgIHZhciBxdWVyeVVybCA9ICdodHRwOi8vcmVnaXN0cnkubnBtanMub3JnLycgKyBlbmNvZGVVUklDb21wb25lbnQoY3VycmVudEtleSkgKyAnL2xhdGVzdCc7XHJcblxyXG4gICAgICAgICAgICByZXR1cm4gcmVxdWVzdC54aHIoe1xyXG4gICAgICAgICAgICAgICAgdXJsIDogcXVlcnlVcmxcclxuICAgICAgICAgICAgfSkudGhlbigoc3VjY2VzcykgPT4ge1xyXG4gICAgICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gSlNPTi5wYXJzZShzdWNjZXNzLnJlc3BvbnNlVGV4dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKG9iaiAmJiBvYmoudmVyc2lvbikge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbiA9IG9iai52ZXJzaW9uO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgbmFtZSA9IEpTT04uc3RyaW5naWZ5KHZlcnNpb24pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkKHsgdHlwZTogJ2NsYXNzJywgZGlzcGxheVRleHQ6IG5hbWUsIHNuaXBwZXQ6IG5hbWUsIGRlc2NyaXB0aW9uOiBgVGhlIGN1cnJlbnRseSBsYXRlc3QgdmVyc2lvbiBvZiB0aGUgcGFja2FnZWAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBKU09OLnN0cmluZ2lmeSgnXicgKyB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZCh7IHR5cGU6ICdjbGFzcycsIGRpc3BsYXlUZXh0OiBuYW1lLCBzbmlwcGV0OiBuYW1lLCBkZXNjcmlwdGlvbjogYE1hdGNoZXMgdGhlIG1vc3QgcmVjZW50IG1ham9yIHZlcnNpb24gKDEueC54KWAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBKU09OLnN0cmluZ2lmeSgnficgKyB2ZXJzaW9uKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZCh7IHR5cGU6ICdjbGFzcycsIGRpc3BsYXlUZXh0OiBuYW1lLCBzbmlwcGV0OiBuYW1lLCBkZXNjcmlwdGlvbjogYE1hdGNoZXMgdGhlIG1vc3QgcmVjZW50IG1pbm9yIHZlcnNpb24gKDEuMi54KWAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGlnbm9yZVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgZ2V0SW5mb0NvbnRyaWJ1dGlvbihyZXNvdXJjZTogVVJJLCBsb2NhdGlvbjogSlNPTkxvY2F0aW9uKTogUHJvbWlzZTxIdG1sQ29udGVudC5JSFRNTENvbnRlbnRFbGVtZW50W10+IHtcclxuICAgICAgICBpZiAodGhpcy5pc1BhY2thZ2VKU09ORmlsZShyZXNvdXJjZSkgJiYgKGxvY2F0aW9uLm1hdGNoZXMoWydkZXBlbmRlbmNpZXMnLCAnKiddKSB8fCBsb2NhdGlvbi5tYXRjaGVzKFsnZGV2RGVwZW5kZW5jaWVzJywgJyonXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ29wdGlvbmFsRGVwZW5kZW5jaWVzJywgJyonXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ3BlZXJEZXBlbmRlbmNpZXMnLCAnKiddKSkpIHtcclxuICAgICAgICAgICAgdmFyIHBhY2sgPSBsb2NhdGlvbi5nZXRTZWdtZW50cygpW2xvY2F0aW9uLmdldFNlZ21lbnRzKCkubGVuZ3RoIC0gMV07XHJcblxyXG4gICAgICAgICAgICB2YXIgaHRtbENvbnRlbnQgOiBIdG1sQ29udGVudC5JSFRNTENvbnRlbnRFbGVtZW50W10gPSBbXTtcclxuICAgICAgICAgICAgaHRtbENvbnRlbnQucHVzaCh7Y2xhc3NOYW1lOiAndHlwZScsIHRleHQ6ICBwYWNrIH0pO1xyXG5cclxuICAgICAgICAgICAgdmFyIHF1ZXJ5VXJsID0gJ2h0dHA6Ly9yZWdpc3RyeS5ucG1qcy5vcmcvJyArIGVuY29kZVVSSUNvbXBvbmVudChwYWNrKSArICcvbGF0ZXN0JztcclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXF1ZXN0Lnhocih7XHJcbiAgICAgICAgICAgICAgICB1cmwgOiBxdWVyeVVybFxyXG4gICAgICAgICAgICB9KS50aGVuKChzdWNjZXNzKSA9PiB7XHJcbiAgICAgICAgICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBvYmogPSBKU09OLnBhcnNlKHN1Y2Nlc3MucmVzcG9uc2VUZXh0KTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAob2JqKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmouZGVzY3JpcHRpb24pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxDb250ZW50LnB1c2goe2NsYXNzTmFtZTogJ2RvY3VtZW50YXRpb24nLCB0ZXh0OiBvYmouZGVzY3JpcHRpb24gfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG9iai52ZXJzaW9uKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sQ29udGVudC5wdXNoKHtjbGFzc05hbWU6ICdkb2N1bWVudGF0aW9uJywgdGV4dDogYExhdGVzdCB2ZXJzaW9uOiAke29iai52ZXJzaW9ufWAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gaWdub3JlXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gaHRtbENvbnRlbnQ7XHJcbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGh0bWxDb250ZW50O1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICB9XHJcbn1cclxuIiwiJ3VzZSBzdHJpY3QnO1xuaW1wb3J0IFN0cmluZ3MgZnJvbSAnLi4vY29tbW9uL3N0cmluZ3MnO1xuaW1wb3J0IHJlcXVlc3QgZnJvbSAncmVxdWVzdC1saWdodCc7XG52YXIgTElNSVQgPSA0MDtcbmV4cG9ydCBjbGFzcyBQYWNrYWdlSlNPTkNvbnRyaWJ1dGlvbiB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMubW9zdERlcGVuZGVkT24gPSBbJ2xvZGFzaCcsICdhc3luYycsICd1bmRlcnNjb3JlJywgJ3JlcXVlc3QnLCAnY29tbWFuZGVyJywgJ2V4cHJlc3MnLCAnZGVidWcnLCAnY2hhbGsnLCAnY29sb3JzJywgJ3EnLCAnY29mZmVlLXNjcmlwdCcsXG4gICAgICAgICAgICAnbWtkaXJwJywgJ29wdGltaXN0JywgJ3Rocm91Z2gyJywgJ3llb21hbi1nZW5lcmF0b3InLCAnbW9tZW50JywgJ2JsdWViaXJkJywgJ2dsb2InLCAnZ3VscC11dGlsJywgJ21pbmltaXN0JywgJ2NoZWVyaW8nLCAnamFkZScsICdyZWRpcycsICdub2RlLXV1aWQnLFxuICAgICAgICAgICAgJ3NvY2tldCcsICdpbycsICd1Z2xpZnktanMnLCAnd2luc3RvbicsICd0aHJvdWdoJywgJ2ZzLWV4dHJhJywgJ2hhbmRsZWJhcnMnLCAnYm9keS1wYXJzZXInLCAncmltcmFmJywgJ21pbWUnLCAnc2VtdmVyJywgJ21vbmdvZGInLCAnanF1ZXJ5JyxcbiAgICAgICAgICAgICdncnVudCcsICdjb25uZWN0JywgJ3lvc2F5JywgJ3VuZGVyc2NvcmUnLCAnc3RyaW5nJywgJ3htbDJqcycsICdlanMnLCAnbW9uZ29vc2UnLCAnbWFya2VkJywgJ2V4dGVuZCcsICdtb2NoYScsICdzdXBlcmFnZW50JywgJ2pzLXlhbWwnLCAneHRlbmQnLFxuICAgICAgICAgICAgJ3NoZWxsanMnLCAnZ3VscCcsICd5YXJncycsICdicm93c2VyaWZ5JywgJ21pbmltYXRjaCcsICdyZWFjdCcsICdsZXNzJywgJ3Byb21wdCcsICdpbnF1aXJlcicsICd3cycsICdldmVudC1zdHJlYW0nLCAnaW5oZXJpdHMnLCAnbXlzcWwnLCAnZXNwcmltYScsXG4gICAgICAgICAgICAnanNkb20nLCAnc3R5bHVzJywgJ3doZW4nLCAncmVhZGFibGUtc3RyZWFtJywgJ2F3cy1zZGsnLCAnY29uY2F0LXN0cmVhbScsICdjaGFpJywgJ3Byb21pc2UnLCAnd3JlbmNoJ107XG4gICAgfVxuICAgIGlzUGFja2FnZUpTT05GaWxlKHJlc291cmNlKSB7XG4gICAgICAgIHZhciBwYXRoID0gcmVzb3VyY2UucGF0aDtcbiAgICAgICAgcmV0dXJuIFN0cmluZ3MuZW5kc1dpdGgocGF0aCwgJy9wYWNrYWdlLmpzb24nKTtcbiAgICB9XG4gICAgY29sbGVjdERlZmF1bHRTdWdnZXN0aW9ucyhyZXNvdXJjZSwgcmVzdWx0KSB7XG4gICAgICAgIGlmICh0aGlzLmlzUGFja2FnZUpTT05GaWxlKHJlc291cmNlKSkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IHtcbiAgICAgICAgICAgICAgICAnbmFtZSc6ICd7e25hbWV9fScsXG4gICAgICAgICAgICAgICAgJ2Rlc2NyaXB0aW9uJzogJ3t7ZGVzY3JpcHRpb259fScsXG4gICAgICAgICAgICAgICAgJ2F1dGhvcic6ICd7e2F1dGhvcn19JyxcbiAgICAgICAgICAgICAgICAndmVyc2lvbic6ICd7ezEuMC4wfX0nLFxuICAgICAgICAgICAgICAgICdtYWluJzogJ3t7cGF0aFRvTWFpbn19JyxcbiAgICAgICAgICAgICAgICAnZGVwZW5kZW5jaWVzJzoge31cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICByZXN1bHQuYWRkKHsgdHlwZTogJ21vZHVsZScsIGRpc3BsYXlUZXh0OiBgRGVmYXVsdCBwYWNrYWdlLmpzb25gLCBzbmlwcGV0OiBKU09OLnN0cmluZ2lmeShkZWZhdWx0VmFsdWUsIG51bGwsICdcXHQnKSwgZGVzY3JpcHRpb246ICcnIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb2xsZWN0UHJvcGVydHlTdWdnZXN0aW9ucyhyZXNvdXJjZSwgbG9jYXRpb24sIGN1cnJlbnRXb3JkLCBhZGRWYWx1ZSwgaXNMYXN0LCByZXN1bHQpIHtcbiAgICAgICAgaWYgKHRoaXMuaXNQYWNrYWdlSlNPTkZpbGUocmVzb3VyY2UpICYmIChsb2NhdGlvbi5tYXRjaGVzKFsnZGVwZW5kZW5jaWVzJ10pIHx8IGxvY2F0aW9uLm1hdGNoZXMoWydkZXZEZXBlbmRlbmNpZXMnXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ29wdGlvbmFsRGVwZW5kZW5jaWVzJ10pIHx8IGxvY2F0aW9uLm1hdGNoZXMoWydwZWVyRGVwZW5kZW5jaWVzJ10pKSkge1xuICAgICAgICAgICAgdmFyIHF1ZXJ5VXJsO1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRXb3JkLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBxdWVyeVVybCA9ICdodHRwczovL3NraW1kYi5ucG1qcy5jb20vcmVnaXN0cnkvX2Rlc2lnbi9hcHAvX3ZpZXcvYnJvd3NlQWxsP2dyb3VwX2xldmVsPTEmbGltaXQ9JyArIExJTUlUICsgJyZzdGFydF9rZXk9JTVCJTIyJyArIGVuY29kZVVSSUNvbXBvbmVudChjdXJyZW50V29yZCkgKyAnJTIyJTVEJmVuZF9rZXk9JTVCJTIyJyArIGVuY29kZVVSSUNvbXBvbmVudChjdXJyZW50V29yZCArICd6JykgKyAnJTIyLCU3QiU3RCU1RCc7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QueGhyKHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBxdWVyeVVybFxuICAgICAgICAgICAgICAgIH0pLnRoZW4oKHN1Y2Nlc3MpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHN1Y2Nlc3Muc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2Uoc3VjY2Vzcy5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvYmogJiYgQXJyYXkuaXNBcnJheShvYmoucm93cykpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBvYmoucm93cztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5cyA9IHJlc3VsdHNbaV0ua2V5O1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoa2V5cykgJiYga2V5cy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBrZXlzWzBdO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb2RlU25pcHBldCA9IEpTT04uc3RyaW5naWZ5KG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlU25pcHBldCArPSAnOiBcInt7Kn19XCInO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTGFzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29kZVNuaXBwZXQgKz0gJywnO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQoeyB0eXBlOiAncHJvcGVydHknLCBkaXNwbGF5VGV4dDogbmFtZSwgc25pcHBldDogY29kZVNuaXBwZXQsIGRlc2NyaXB0aW9uOiAnJyB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0cy5sZW5ndGggPT09IExJTUlUKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQuc2V0QXNJbmNvbXBsZXRlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmVycm9yKGBSZXF1ZXN0IHRvIHRoZSBOUE0gcmVwb3NpdG9yeSBmYWlsZWQ6ICR7c3VjY2Vzcy5yZXNwb25zZVRleHR9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuZXJyb3IoYFJlcXVlc3QgdG8gdGhlIE5QTSByZXBvc2l0b3J5IGZhaWxlZDogJHtlcnJvci5yZXNwb25zZVRleHR9YCk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAwO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5tb3N0RGVwZW5kZWRPbi5mb3JFYWNoKChuYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjb2RlU25pcHBldCA9IEpTT04uc3RyaW5naWZ5KG5hbWUpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWRkVmFsdWUpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVTbmlwcGV0ICs9ICc6IFwie3sqfX1cIic7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWlzTGFzdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGVTbmlwcGV0ICs9ICcsJztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXN1bHQuYWRkKHsgdHlwZTogJ3Byb3BlcnR5JywgZGlzcGxheVRleHQ6IG5hbWUsIHNuaXBwZXQ6IGNvZGVTbmlwcGV0LCBkZXNjcmlwdGlvbjogJycgfSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnNldEFzSW5jb21wbGV0ZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb2xsZWN0VmFsdWVTdWdnZXN0aW9ucyhyZXNvdXJjZSwgbG9jYXRpb24sIGN1cnJlbnRLZXksIHJlc3VsdCkge1xuICAgICAgICBpZiAodGhpcy5pc1BhY2thZ2VKU09ORmlsZShyZXNvdXJjZSkgJiYgKGxvY2F0aW9uLm1hdGNoZXMoWydkZXBlbmRlbmNpZXMnXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ2RldkRlcGVuZGVuY2llcyddKSB8fCBsb2NhdGlvbi5tYXRjaGVzKFsnb3B0aW9uYWxEZXBlbmRlbmNpZXMnXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ3BlZXJEZXBlbmRlbmNpZXMnXSkpKSB7XG4gICAgICAgICAgICB2YXIgcXVlcnlVcmwgPSAnaHR0cDovL3JlZ2lzdHJ5Lm5wbWpzLm9yZy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KGN1cnJlbnRLZXkpICsgJy9sYXRlc3QnO1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QueGhyKHtcbiAgICAgICAgICAgICAgICB1cmw6IHF1ZXJ5VXJsXG4gICAgICAgICAgICB9KS50aGVuKChzdWNjZXNzKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2Uoc3VjY2Vzcy5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqICYmIG9iai52ZXJzaW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdmVyc2lvbiA9IG9iai52ZXJzaW9uO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5hbWUgPSBKU09OLnN0cmluZ2lmeSh2ZXJzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQoeyB0eXBlOiAnY2xhc3MnLCBkaXNwbGF5VGV4dDogbmFtZSwgc25pcHBldDogbmFtZSwgZGVzY3JpcHRpb246IGBUaGUgY3VycmVudGx5IGxhdGVzdCB2ZXJzaW9uIG9mIHRoZSBwYWNrYWdlYCB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUgPSBKU09OLnN0cmluZ2lmeSgnXicgKyB2ZXJzaW9uKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5hZGQoeyB0eXBlOiAnY2xhc3MnLCBkaXNwbGF5VGV4dDogbmFtZSwgc25pcHBldDogbmFtZSwgZGVzY3JpcHRpb246IGBNYXRjaGVzIHRoZSBtb3N0IHJlY2VudCBtYWpvciB2ZXJzaW9uICgxLngueClgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZSA9IEpTT04uc3RyaW5naWZ5KCd+JyArIHZlcnNpb24pO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LmFkZCh7IHR5cGU6ICdjbGFzcycsIGRpc3BsYXlUZXh0OiBuYW1lLCBzbmlwcGV0OiBuYW1lLCBkZXNjcmlwdGlvbjogYE1hdGNoZXMgdGhlIG1vc3QgcmVjZW50IG1pbm9yIHZlcnNpb24gKDEuMi54KWAgfSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIDA7XG4gICAgICAgICAgICB9LCAoZXJyb3IpID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gMDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBnZXRJbmZvQ29udHJpYnV0aW9uKHJlc291cmNlLCBsb2NhdGlvbikge1xuICAgICAgICBpZiAodGhpcy5pc1BhY2thZ2VKU09ORmlsZShyZXNvdXJjZSkgJiYgKGxvY2F0aW9uLm1hdGNoZXMoWydkZXBlbmRlbmNpZXMnLCAnKiddKSB8fCBsb2NhdGlvbi5tYXRjaGVzKFsnZGV2RGVwZW5kZW5jaWVzJywgJyonXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ29wdGlvbmFsRGVwZW5kZW5jaWVzJywgJyonXSkgfHwgbG9jYXRpb24ubWF0Y2hlcyhbJ3BlZXJEZXBlbmRlbmNpZXMnLCAnKiddKSkpIHtcbiAgICAgICAgICAgIHZhciBwYWNrID0gbG9jYXRpb24uZ2V0U2VnbWVudHMoKVtsb2NhdGlvbi5nZXRTZWdtZW50cygpLmxlbmd0aCAtIDFdO1xuICAgICAgICAgICAgdmFyIGh0bWxDb250ZW50ID0gW107XG4gICAgICAgICAgICBodG1sQ29udGVudC5wdXNoKHsgY2xhc3NOYW1lOiAndHlwZScsIHRleHQ6IHBhY2sgfSk7XG4gICAgICAgICAgICB2YXIgcXVlcnlVcmwgPSAnaHR0cDovL3JlZ2lzdHJ5Lm5wbWpzLm9yZy8nICsgZW5jb2RlVVJJQ29tcG9uZW50KHBhY2spICsgJy9sYXRlc3QnO1xuICAgICAgICAgICAgcmV0dXJuIHJlcXVlc3QueGhyKHtcbiAgICAgICAgICAgICAgICB1cmw6IHF1ZXJ5VXJsXG4gICAgICAgICAgICB9KS50aGVuKChzdWNjZXNzKSA9PiB7XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IEpTT04ucGFyc2Uoc3VjY2Vzcy5yZXNwb25zZVRleHQpO1xuICAgICAgICAgICAgICAgICAgICBpZiAob2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLmRlc2NyaXB0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbENvbnRlbnQucHVzaCh7IGNsYXNzTmFtZTogJ2RvY3VtZW50YXRpb24nLCB0ZXh0OiBvYmouZGVzY3JpcHRpb24gfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAob2JqLnZlcnNpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sQ29udGVudC5wdXNoKHsgY2xhc3NOYW1lOiAnZG9jdW1lbnRhdGlvbicsIHRleHQ6IGBMYXRlc3QgdmVyc2lvbjogJHtvYmoudmVyc2lvbn1gIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBodG1sQ29udGVudDtcbiAgICAgICAgICAgIH0sIChlcnJvcikgPT4ge1xuICAgICAgICAgICAgICAgIHJldHVybiBodG1sQ29udGVudDtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==
